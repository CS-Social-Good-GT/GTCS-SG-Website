"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = SanityStatus;

var _propTypes = _interopRequireDefault(require("prop-types"));

var _react = _interopRequireDefault(require("react"));

var _packageIcon = _interopRequireDefault(require("part:@sanity/base/package-icon"));

var _UpdateNotifierDialog = _interopRequireDefault(require("./UpdateNotifierDialog"));

var _CurrentVersionsDialog = _interopRequireDefault(require("./CurrentVersionsDialog"));

var _SanityStatus = _interopRequireDefault(require("./styles/SanityStatus.css"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function formatUpdateLabel(len) {
  if (len === 1) return ' 1 update';
  return "".concat(len, " updates");
}

function SanityStatus(props) {
  var isSupported = props.isSupported,
      isUpToDate = props.isUpToDate,
      level = props.level,
      onHideDialog = props.onHideDialog,
      onShowDialog = props.onShowDialog,
      outdated = props.outdated,
      showDialog = props.showDialog,
      versions = props.versions;
  var currentLevel = outdated.length ? level : 'notice';
  var severity = isSupported ? currentLevel : 'high';
  var Dialog = isUpToDate ? _CurrentVersionsDialog.default : _UpdateNotifierDialog.default;
  return /*#__PURE__*/_react.default.createElement("div", {
    className: _SanityStatus.default.root
  }, showDialog && /*#__PURE__*/_react.default.createElement(Dialog, {
    severity: severity,
    outdated: outdated,
    onClose: onHideDialog,
    versions: versions
  }), /*#__PURE__*/_react.default.createElement("button", {
    className: _SanityStatus.default.button,
    onClick: onShowDialog,
    type: "button"
  }, /*#__PURE__*/_react.default.createElement("div", {
    className: _SanityStatus.default.buttonInner,
    tabIndex: -1
  }, isUpToDate ? /*#__PURE__*/_react.default.createElement("span", null, "Up to date") : /*#__PURE__*/_react.default.createElement("div", {
    className: _SanityStatus.default.hasUpdates
  }, /*#__PURE__*/_react.default.createElement("span", {
    className: _SanityStatus.default.updateIcon
  }, /*#__PURE__*/_react.default.createElement("div", {
    className: _SanityStatus.default.updateIndicator,
    "data-severity": severity,
    "aria-label": "".concat(severity, " severity level.")
  }), /*#__PURE__*/_react.default.createElement(_packageIcon.default, null)), /*#__PURE__*/_react.default.createElement("span", {
    className: _SanityStatus.default.updateLabel
  }, formatUpdateLabel(outdated.length))))));
}

SanityStatus.defaultProps = {
  outdated: []
};
SanityStatus.propTypes = {
  isUpToDate: _propTypes.default.bool.isRequired,
  isSupported: _propTypes.default.bool.isRequired,
  level: _propTypes.default.string.isRequired,
  onHideDialog: _propTypes.default.func.isRequired,
  onShowDialog: _propTypes.default.func.isRequired,
  outdated: _propTypes.default.array,
  showDialog: _propTypes.default.bool.isRequired,
  versions: _propTypes.default.any.isRequired
};